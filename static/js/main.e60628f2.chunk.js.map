{"version":3,"sources":["index.js","../node_modules/express/lib sync"],"names":["axios","require","default","app","express","port","process","PORT","listen","console","log","KiotHelper","onDone","post","headers","baseURL","then","response","data","token","catch","error","page","get","this","params","a","totalItem","length","getProducts","result","list","concat","filter","item","instance","req","res","authen","getAllSellingProducts","send","webpackEmptyContext","e","Error","code","keys","resolve","module","exports","id"],"mappings":"6LAAiBA,EAAUC,EAAQ,KAA3BC,QAEFC,EADUF,EAAQ,IACZG,GACNC,EAAOC,mIAAYC,MAAQ,IAGjCJ,EAAIK,OAAOH,GAAM,kBAAMI,QAAQC,IAAR,4BAAiCL,O,IAIlDM,E,sFAGF,SAAOC,GAAS,IAAD,OACXZ,EAAMa,KAAK,iBACP,8JACA,CACIC,QAAS,CACL,eAAgB,qCAEpBC,QAAS,2BAEfC,MAAK,SAACC,GACJR,QAAQC,IAAI,WAAYO,EAASC,MACjC,EAAKC,MAAQF,EAASC,KAAT,gBACdE,OAAM,SAACC,GACNZ,QAAQC,IAAI,QAASW,MACtBL,MAAK,WAEJP,QAAQC,IAAI,eACZE,S,yBAIR,SAAYU,GAER,OADAb,QAAQC,IAAI,uBAAwBY,GAC7BtB,EAAMuB,IAAI,YAEb,CACIT,QAAS,CACL,SAAY,iBACZ,cAAkB,UAAYU,KAAKL,OAEvCM,OAAQ,CACJ,SAAY,IACZ,mBAAeH,QAAf,IAAeA,IAAQ,EACvB,kBAAoB,GAExBP,QAAS,iC,0EAIrB,WAA4BH,GAA5B,yBAAAc,EAAA,sDACQR,EAAO,GACPI,EAAO,EACPK,EAAY,IAHpB,YAIWT,EAAKU,QAAUD,GAJ1B,iCAK2BH,KAAKK,YAAYP,GAL5C,OAKYQ,EALZ,OAQoB,OADRC,EAAOD,EAAOZ,KAAP,QAEPA,EAAOA,EAAKc,OAAOD,IAEvBJ,EAAS,UAAGG,EAAOZ,KAAP,aAAH,QAA2B,GACpCI,GAAc,EAZtB,uBAcIb,QAAQC,IAAI,oBACZQ,EAAOA,EAAKe,QAAO,SAAAC,GAAI,OAAKA,EAAI,YAAgB,GAApB,OAAoC,KAChEtB,EAAOM,GAhBX,iD,8DA1CEP,EACKwB,SAAW,IAAIxB,EA+D1BR,EAAIoB,IAAI,aAAa,SAACa,EAAKC,GACnB1B,EAAWwB,SAAShB,MACpBR,EAAWwB,SAASG,QAAO,WACvB3B,EAAWwB,SAASI,uBAAsB,SAACT,GACvCO,EAAIG,KAAKV,a,sHC9EzB,SAASW,EAAoBL,GAC5B,IAAIM,EAAI,IAAIC,MAAM,uBAAyBP,EAAM,KAEjD,MADAM,EAAEE,KAAO,mBACHF,EAEPD,EAAoBI,KAAO,WAAa,MAAO,IAC/CJ,EAAoBK,QAAUL,EAC9BM,EAAOC,QAAUP,EACjBA,EAAoBQ,GAAK,K","file":"static/js/main.e60628f2.chunk.js","sourcesContent":["const { default: axios } = require('axios');\nconst express = require('express'); //Line 1\nconst app = express(); //Line 2\nconst port = process.env.PORT || 5000;\n\n\napp.listen(port, () => console.log(`Listening on port ${port}`));\n\n\n\nclass KiotHelper {\n    static instance = new KiotHelper();\n\n    authen(onDone) {\n        axios.post('/connect/token',\n            \"scopes=PublicApi.Access&grant_type=client_credentials&client_id=7bc72ce2-8680-41d6-ac3d-253cdd1eacb2&client_secret=AD38790F89BE9C5A9EC9411F8EC73B1E89F3EA3A\",\n            {\n                headers: {\n                    \"Content-Type\": \"application/x-www-form-urlencoded\"\n                },\n                baseURL: 'https://id.kiotviet.vn'\n            }\n        ).then((response) => {\n            console.log(\"respnose\", response.data);\n            this.token = response.data[\"access_token\"];\n        }).catch((error) => {\n            console.log(\"eerrr\", error)\n        }).then(function () {\n            // always executed\n            console.log(\"always call\")\n            onDone();\n        });\n    }\n\n    getProducts(page) {\n        console.log(\"call api with page: \", page);\n        return axios.get('/products',\n\n            {\n                headers: {\n                    \"Retailer\": \"dochoikidworld\",\n                    \"Authorization\": (\"Bearer \" + this.token)\n                },\n                params: {\n                    \"pageSize\": 100,\n                    \"currentItem\": page ?? 0,\n                    \"includeInventory\": true,\n                },\n                baseURL: \"https://public.kiotapi.com\"\n            });\n    }\n\n    async getAllSellingProducts(onDone) {\n        var data = [];\n        var page = 1;\n        var totalItem = 100;\n        while (data.length <= totalItem) {\n            var result = await this.getProducts(page);\n            // console.log(\"result = \", result)\n            var list = result.data['data'];\n            if (list != null) {\n                data = data.concat(list);\n            }\n            totalItem = result.data[\"total\"] ?? 10;\n            page = page + 1;\n        }\n        console.log(\"done with result\");\n        data = data.filter(item => (item[\"inventories\"][0][\"onHand\"]) > 0);\n        onDone(data)\n    }\n}\n\n\n// create a GET route\napp.get('/products', (req, res) => {\n    if (KiotHelper.instance.token == null) {\n        KiotHelper.instance.authen(() => {\n            KiotHelper.instance.getAllSellingProducts((result) => {\n                res.send(result);\n            });\n        })\n    } else {\n        KiotHelper.instance.authen(() => {\n            KiotHelper.instance.getAllSellingProducts((result) => {\n                res.send(result);\n            });\n        })\n    }\n}); //Line 11\n","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 265;"],"sourceRoot":""}